# 场景管理指南

本文档提供了如何管理公安决策支持系统中的案例场景的指南。系统现在支持通过配置文件和辅助脚本来灵活管理场景，无需修改代码。

## 场景配置文件

所有场景配置都存储在 `app/data/scenarios-config.json` 文件中，这个文件定义了：

- 主场景类别（如刑事案件、交通案件等）
- 每个主场景下的子场景
- 各场景对应的目录结构

配置文件的结构如下：

```json
{
  "scenarioCategories": [
    {
      "id": 1,
      "title": "场景标题",
      "description": "场景描述",
      "baseDirectory": "场景基础目录",
      "subScenarios": [
        {
          "id": "子场景ID",
          "title": "子场景标题",
          "description": "子场景描述",
          "directory": "子场景目录"
        }
      ]
    }
  ]
}
```

## 管理场景的方式

### 1. 使用交互式工具添加场景

最简单的方式是使用我们提供的交互式工具：

```bash
node scripts/add-scenario.js
```

这个脚本会引导你完成以下步骤：
- 输入新场景的标题、描述和目录名
- 添加子场景，包括标题、描述和目录名
- 自动生成场景ID
- 更新配置文件

### 2. 创建场景目录结构

配置文件更新后，运行以下命令创建对应的目录结构：

```bash
node scripts/create-scenario-dirs.js
```

这个脚本会：
- 读取配置文件
- 在 `data/scenarios` 目录下创建所有场景的目录结构
- 跳过已存在的目录

### 3. 直接编辑配置文件

如果你熟悉JSON格式，也可以直接编辑 `app/data/scenarios-config.json` 文件：

1. 手动编辑文件，添加或修改场景
2. 保存文件
3. 运行 `node scripts/create-scenario-dirs.js` 创建对应目录

### 4. 添加案例文件

场景目录创建完成后，你需要：

1. 准备相关的TXT格式案例文件
2. 将文件复制到对应的场景目录中，例如：
   - `data/scenarios/刑事案件/1、立案前材料/案例文件.txt`
   - `data/scenarios/福尔摩斯/现场勘验分析/现场勘验报告.txt`

## 场景ID规则

系统使用场景ID来标识不同的场景，ID命名规则：

- 主场景：使用数字ID，从1开始
- 子场景：使用格式 `[主场景拼音前缀]_[序号]`，例如：
  - `criminal_1`: 刑事案件的第一个子场景
  - `sherlock_2`: 福尔摩斯的第二个子场景

使用脚本添加场景时，系统会自动生成合适的ID。

## 重启应用

完成场景配置和文件添加后，重启应用以加载新场景：

```bash
npm run dev
```

## 故障排除

如果新添加的场景没有正确显示，请检查：

1. 配置文件格式是否正确
2. 目录结构是否已创建
3. ID是否唯一
4. 重启应用是否成功

如果问题仍然存在，请查看控制台日志或服务器日志，可能会提供更多错误信息。 